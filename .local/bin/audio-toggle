#!/usr/bin/env bash
set -euo pipefail

wpctl set-mute "@DEFAULT_SINK@" toggle

if wpctl get-volume "@DEFAULT_SINK@" | grep -q MUTED; then
  echo 0 >${XDG_RUNTIME_DIR}/wob.sock
else
  wpctl get-volume "@DEFAULT_SINK@" | sed -r 's/([^0-9]*([0-9]*)){2}.*/\2/' >${XDG_RUNTIME_DIR}/wob.sock
fi
